(couchdb)=

# CouchDB

<meta name="description" content="Documentation for the couchdb monitor">

## Description

The {ref}`Splunk Distribution of OpenTelemetry Collector <otel-intro>` provides this integration as the `couchdb` monitor via the Smart Agent receiver. It monitors metrics from CouchDB instances by calling the `_stats` endpoint for instances.

## Installation

1. Deploy the Splunk Distribution of OpenTelemetry Collector to your host or container platform.
2. Download [collectd-couchdb](https://github.com/signalfx/collectd-couchdb) in GitHub.
3. Move the `couchdb_plugin.py` file to `/usr/share/collectd/collectd-couchdb`.
4. Modify the [sample configuration file](https://github.com/signalfx/integrations/blob/master/collectd-couchdb/10-couchdb.conf) for the plugin in `/etc/collectd/managed_config` according to the [Configuration](#configuration) section.
5. Install the Python requirements:

   ```
   $ sudo pip install -r requirements.txt
   ```
6. Restart the OpenTelemetry collector.

## Configuration

The Splunk Distribution of OpenTelemetry Collector allows embedding a Smart Agent monitor configuration in an associated Smart Agent Receiver instance.

**Note:** Providing a CouchDB monitor entry in your Smart Agent or Collector configuration is required for its use. Use the appropriate form for your agent type.

### Smart Agent

To activate this monitor in the Smart Agent, add the following to your agent configuration:
```
monitors:  # All monitor config goes under this key
 - type: couchdb
   ...  # Additional config
```

See <a href="https://docs.splunk.com/Observability/gdi/smart-agent/smart-agent-resources.html#configure-the-smart-agent" target="_blank">Smart Agent example configuration</a> for an autogenerated example of a YAML configuration file, with default values where applicable.

### Splunk Distribution of OpenTelemetry Collector

To activate this monitor in the Splunk Distribution of OpenTelemetry Collector, add the following to your agent configuration:

```
receivers:
  smartagent/couchdb:
    type: couchdb
    ...  # Additional config
```

To complete the monitor activation, you must also include the `smartagent/couchdb` receiver item in a `metrics` pipeline. To do this, add the receiver item to the `service` > `pipelines` > `metrics` > `receivers` section of your configuration file.

See <a href="https://github.com/signalfx/splunk-otel-collector/tree/main/examples" target="_blank">configuration examples</a> for specific use cases that show how the Splunk OpenTelemetry Collector can integrate and complement existing environments.

### Configuration settings

The following table shows the configuration options for this monitor:

| Option | Definition | Example value |
| ---------------------|------------|---------------|
| ModulePath | Path on disk where collectd can find this module. | "/usr/share/collectd/collectd-couchdb/" |
| Host | Host name of the CouchDB member | "localhost" |
| Port | Port at which the member can be reached | "5984" |
| Node | Name of the CouchDB node in the cluster | "couchdb@test\_node" |
| EnhancedMetrics | Boolean; `true` to indicate if the uncommented enhanced metrics in couchdb_metrics.py are needed. | "false" |
| Username | Username required for authentication of CouchDB | "admin" |
| Password | Password required for authentication of CouchDB | "admin" |
| IncludeMetric | Metric emitted by `_stats` api to be enabled. | "metric listed in docs" |
| ExcludeMetric | Metric emitted by `_stats` api to be disabled. | "metric listed in docs" |
| Dimension | Space-separated key-value pair for a user-defined dimension | dimension\_name dimension\_value |
| Interval | Number of seconds between calls to CouchDB API. | 10 |
| ssl\_keyfile | Path to the keyfile | "path/to/file" |
| ssl\_certificate | Path to the certificate | "path/to/file" |
| ssl\_ca\_certs | Path to the ca file | "path/to/file" |

## Metrics


The following metrics are available for this integration:

<div class="metrics-yaml" url="https://raw.githubusercontent.com/signalfx/integrations/master/collectd-couchdb/metrics.yaml"></div>

## Troubleshooting

```{include} /_includes/troubleshooting.md
```
